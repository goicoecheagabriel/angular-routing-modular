<app-titulo titulo="Nuevo Modelo"></app-titulo>

<form (ngSubmit)="crearNuevo()" [formGroup]="formModelo" autocomplete="off" class="container">
  <div class="grid">
    <div
      class="
        col-10 col-offset-1
        sm:col-8 sm:col-offset-2
        xl:col-6 xl:col-offset-3
      "
    >
      <p-card>
        <div class="field grid">
          <label for="nombre" class="col-fixed" style="width: 100px"
            >Nombre</label
          >
          <div class="col">
            <input
              formControlName="nombre"
              id="nombre"
              type="text"
              placeholder="Nombre del modelo"
              pInputText
              aria-describedby="nombre-help" 
              class="p-invalid"
            />
            <br>
            <small 
              *ngIf="campoInvalido('nombre') "  
              id="nombre-help" 
              class="p-error">
              <span *ngIf="formModelo.controls.nombre?.errors?.exists">El nombre soliciatado no esta disponible.</span>
              <span *ngIf="formModelo.controls.nombre?.errors && !formModelo.controls.nombre?.errors?.exists">El nombre debe ser una palabra de 5 a 15 caracteres.</span>
            </small>
            
          </div>
        </div>
        <!-- <div class="p-field p-fluid">
          <label for="nombre" style="width: 100px">Nombre</label>
          <input 
            formControlName="nombre" 
            placeholder="Nombre del modelo" 
            id="nombre" 
            type="username" 
            aria-describedby="nombre-help" 
            class="p-invalid" 
            pInputText />
          <small *ngIf="false"  id="nombre-help" class="p-error">El nombre debe contener entre 5 y 15 caracteres.</small>
      </div> -->

        <div class="field grid">
          <label for="descripcion" class="col-fixed" style="width: 100px"
            >Descripci贸n</label
          >
          <div class="col">
            <input
              formControlName="descripcion"
              id="descripcion"
              type="text"
              placeholder="Describa su modelo"
              pInputText
              class="inputtext component element"
            />
            <br>
            <small 
              *ngIf="campoInvalido('descripcion')"  
              id="descripcion-help" 
              class="p-error">
              Debe incluir una descripci贸n de entre 7 y 50 caracteres.
            </small>
          </div>
        </div>

        <div class="grid">
          <div class="col-4 flex-grow-0">
            <div class="">
              <label for="latitud" class="">Latitud</label>
              <input
                formControlName="latitud"
                type="text"
                pInputText
                style="width: 80px"
                id="latitud"
                placeholder="Ingrese latitud"
              />
            </div>
          </div>
          <div class="col-4 flex-grow-0">
            <div class="">
              <label for="longitud" class="">Longitud</label>
              <input
                formControlName="longitud"
                type="text"
                pInputText
                style="width: 80px"
                id="longitud"
                placeholder="Ingrese latitud"
              />
            </div>
          </div>

          <div
            class="col-4 flex-grow-1 grid justify-content-start align-items-end"
          >
            <button (click)="getCoordenadas()" pButton type="button">
              <i class="las la-map-marker-alt"></i>
              <span>obtener</span>
            </button>
          </div>

          <br>
            <small 
              *ngIf="campoInvalido('latitud') || campoInvalido('longitud')"  
              id="ubicacion-help" 
              class="p-error">
              Por favor seleccione una ubicaci贸n.
            </small>

          <div #viewCoords id="mapa" style="width:100%; margin-bottom: 1rem;">
            <app-view-coords [lng]="lng" [lat]="lat" [establecer]="establecer" ></app-view-coords>
          </div>

        </div>

        <div class="field grid">
          <label for="modeloId" class="col-fixed" style="width: 100px">Modelo</label>
          <div class="col">
            <input
              formControlName="modeloId"
              id="modeloId"
              type="text"
              placeholder="Ingrese id del modelo"
              pInputText
              class="inputtext"
            />
            <br>
            <small 
              *ngIf="campoInvalido('modeloId')"  
              id="modeloId-help" 
              class="p-error">
              El formato del modelo no es correcto.
            </small>
          </div>
        </div>

        <ng-template pTemplate="footer">
          <button pButton type="submit" label="Enviar"></button>
        </ng-template>
      </p-card>
    </div>
  </div>
</form>

<div>
  <p-dialog 
  (onHide)="cerrarModal()"
  [modal]="false"
  [draggable]="false"
  [resizable]="false"
  appendTo="body"
  header="Selecciona la ubicaci贸n del modelo" 
  [(visible)]="display" 
  [breakpoints]="{'960px': '75vw', '768px': '60vw', '560px': '98%'}" 
  [style]="{width: '50vw', minHeight:'300px', height:'60vh'}" >
  <!-- [style]="{width: '300px', height: '60vh'}"> -->

  <div #getCoords>
    <app-get-coords (actualPosition)="actualPosition($event)"></app-get-coords>
  </div>

  <!-- <ng-template pTemplate="footer">
    <button pButton label="Establecer">
      <i class="las la-map-marker"></i>
    </button>
  </ng-template> -->
</p-dialog>
</div>


<div class="block">
  <div class="grid p-4">
    <div class="col-1">
      <span>Valid</span>
      <pre>{{ formModelo.valid | json }}</pre>
    </div>

    <div class="col-2">
      <span>Pristine</span>
      <pre>{{ formModelo.pristine }}</pre>
    </div>

    <div class="col-2">
      <span>Touched</span>
      <pre>{{ formModelo.touched }}</pre>
    </div>

    <div class="col">
      <span>Valores</span>
      <pre>{{ formModelo.value | json }}</pre>
    </div>

    <div class="col">
      <div>
        <span> Errors - Nombre </span>
        <pre>{{ formModelo.controls.nombre.errors | json }}</pre>
      </div>

      <div>
        <span> Errors - Descripcion </span>
        <pre>{{ formModelo.controls.descripcion.errors | json }}</pre>
      </div>

      <div>
        <span> Errors - Latitud </span>
        <pre>{{ formModelo.controls.latitud.errors | json }}</pre>
      </div>

      <div>
        <span> Errors - Longitud </span>
        <pre>{{ formModelo.controls.longitud.errors | json }}</pre>
      </div>

      <div>
        <span> Errors - Url </span>
        <pre>{{ formModelo.controls.modeloId.errors | json }}</pre>
      </div>
    </div>
  </div>
</div>
